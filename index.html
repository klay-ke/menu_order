<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å°æŸ¯ç§å¨ - ç²¾è‡´ç‚¹é¤</title>
    <style>
        :root { --primary-color: #f39c12; --bg-main: #f0f2f5; --card-bg: #ffffff; }
        body { font-family: 'PingFang SC', system-ui, sans-serif; background-color: var(--bg-main); margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }
        
        .phone-container { width: 94%; max-width: 420px; height: 92vh; background: var(--card-bg); border-radius: 24px; box-shadow: 0 10px 40px rgba(0,0,0,0.08); display: flex; flex-direction: column; overflow: hidden; position: relative; }
        header { padding: 12px 0; text-align: center; background: #fff; border-bottom: 1px solid #f0f0f0; flex-shrink: 0; }
        h1 { color: #e67e22; font-size: 18px; margin: 0; letter-spacing: 1px; }

        /* é¢„çº¦åŒº */
        .reservation-bar { background: #fffaf0; padding: 10px 15px; display: flex; gap: 10px; border-bottom: 1px solid #ffeaa7; flex-shrink: 0; }
        .res-item { flex: 1; display: flex; flex-direction: column; gap: 4px; }
        .res-item label { font-size: 11px; color: #e67e22; font-weight: bold; }
        .res-item input, .res-item select { border: 1px solid #f39c12; border-radius: 6px; padding: 4px; font-size: 13px; outline: none; background: white; }

        .main-content { display: flex; flex: 1; overflow: hidden; }

        /* å·¦ä¾§å¯¼èˆª */
        .sidebar { width: 85px; background: #f7f7f7; overflow-y: auto; border-right: 1px solid #eee; flex-shrink: 0; }
        .nav-item { padding: 22px 8px; font-size: 13px; text-align: center; color: #777; cursor: pointer; border-left: 3px solid transparent; transition: 0.2s; }
        .nav-item.active { background: white; color: var(--primary-color); font-weight: bold; border-left-color: var(--primary-color); }

        /* å³ä¾§èœå• */
        .menu-content { flex: 1; overflow-y: auto; padding: 0 12px; scroll-behavior: smooth; }
        .category-section { padding-top: 10px; }
        .category-section:last-child { padding-bottom: 300px; } 
        .category-title { font-size: 12px; color: #999; margin: 20px 0 10px 0; font-weight: bold; }

        .menu-grid { display: grid; grid-template-columns: 1fr; gap: 10px; }
        .menu-item { display: flex; align-items: center; background: white; padding: 14px; border-radius: 12px; border: 1px solid #f0f0f0; cursor: pointer; transition: 0.2s; }
        .menu-item.selected { border-color: var(--primary-color); background-color: #fffaf0; box-shadow: 0 2px 8px rgba(243,156,18,0.1); }
        .menu-item input[type="checkbox"] { display: none; }
        .menu-item .emoji { font-size: 24px; margin-right: 12px; pointer-events: none; }
        .menu-item .name { flex: 1; font-weight: 500; font-size: 15px; color: #333; pointer-events: none; }
        .menu-item .check-icon { color: var(--primary-color); display: none; pointer-events: none; font-weight: bold; }
        .menu-item.selected .check-icon { display: block; }

        .custom-input-box { margin-top: 10px; padding: 10px; background: #fffcf5; border-radius: 12px; border: 1px dashed #f39c12; }
        .custom-input-box input { width: 100%; border: none; background: transparent; outline: none; font-size: 14px; color: #666; padding: 5px 0; }

        /* åº•éƒ¨å›ºå®šæ  */
        .footer-bar { position: absolute; bottom: 0; left: 0; width: 100%; background: rgba(255,255,255,0.98); border-top: 1px solid #eee; padding: 12px 20px; box-sizing: border-box; display: flex; align-items: center; justify-content: space-between; padding-bottom: calc(12px + env(safe-area-inset-bottom)); z-index: 10; }
        .submit-btn { background: linear-gradient(135deg, #f39c12, #e67e22); color: white; border: none; padding: 10px 24px; border-radius: 20px; font-size: 15px; font-weight: bold; box-shadow: 0 4px 10px rgba(230,126,34,0.2); cursor: pointer; }
        
        /* å¼¹çª— */
        #remarkModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 100; justify-content: center; align-items: center; backdrop-filter: blur(2px); }
        .modal-content { background: white; width: 280px; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .modal-content p { margin: 0 0 10px 0; font-weight: bold; color: #555; text-align: center; }
        textarea { width: 100%; height: 80px; border: 1px solid #ddd; border-radius: 10px; padding: 12px; box-sizing: border-box; margin-top: 10px; outline: none; font-size: 14px; }
        .modal-btns { display: flex; gap: 10px; margin-top: 20px; }
        .btn-cancel { background: #f0f0f0; flex: 1; border: none; padding: 10px; border-radius: 12px; color: #888; cursor: pointer; }
        .btn-confirm { background: var(--primary-color); color: white; flex: 2; border: none; padding: 10px; border-radius: 12px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

<div class="phone-container">
    <header><h1>ğŸ‘¨â€ğŸ³ å°æŸ¯ç§å¨</h1></header>
    
    <div class="reservation-bar">
        <div class="res-item">
            <label>ç”¨é¤æ—¥æœŸ</label>
            <input type="date" id="orderDate">
        </div>
        <div class="res-item">
            <label>ç”¨é¤æ—¶é—´</label>
            <select id="orderTime">
                <option value="åˆé¥­">åˆé¥­ â˜€ï¸</option>
                <option value="æ™šé¥­">æ™šé¥­ ğŸŒ™</option>
            </select>
        </div>
    </div>

    <div class="main-content">
        <div class="sidebar">
            <div class="nav-item active" data-target="meat">ç²¾é€‰è¤èœ</div>
            <div class="nav-item" data-target="veggie">æ¸…æ–°ç´ èœ</div>
            <div class="nav-item" data-target="soup">æ»‹è¡¥æ±¤å“</div>
            <div class="nav-item" data-target="staple">ç‰¹è‰²ä¸»é£Ÿ</div>
            <div class="nav-item" data-target="drink">é…’æ°´é¥®å“</div>
            <div class="nav-item" data-target="custom">å¤§å¨ç›²ç›’</div>
        </div>
        <div class="menu-content" id="menuContent">
            <form id="orderForm">
                <div id="meat" class="category-section">
                    <div class="category-title">ç²¾é€‰è¤èœ</div>
                    <div class="menu-grid">
                        <label class="menu-item"><input type="checkbox" name="dishes" value="çº¢çƒ§é±¼"><span class="emoji">ğŸŸ</span><span class="name">çº¢çƒ§é±¼</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="è’œé¦™æ’éª¨"><span class="emoji">ğŸ§„</span><span class="name">è’œé¦™æ’éª¨</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="é…±å¤§éª¨"><span class="emoji">ğŸ¦´</span><span class="name">é…±å¤§éª¨</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="ç³–é†‹æ’éª¨"><span class="emoji">ğŸ–</span><span class="name">ç³–é†‹æ’éª¨</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="çº¢çƒ§è‚‰"><span class="emoji">ğŸ¥©</span><span class="name">çº¢çƒ§è‚‰</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="é”…åŒ…è‚‰"><span class="emoji">ğŸ¥“</span><span class="name">é”…åŒ…è‚‰</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="é’æ¤’ç‚’ç‰›è‚‰"><span class="emoji">ğŸ‚</span><span class="name">é’æ¤’ç‚’ç‰›è‚‰</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="å¯ä¹é¸¡ç¿…"><span class="emoji">ğŸ—</span><span class="name">å¯ä¹é¸¡ç¿…</span><span class="check-icon">âœ“</span></label>
                    </div>
                </div>
                <div id="veggie" class="category-section">
                    <div class="category-title">æ¸…æ–°ç´ èœ</div>
                    <div class="menu-grid">
                        <label class="menu-item"><input type="checkbox" name="dishes" value="èšæ²¹ç”Ÿèœ"><span class="emoji">ğŸ¥¬</span><span class="name">èšæ²¹ç”Ÿèœ</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="é…¸è¾£åœŸè±†ä¸"><span class="emoji">ğŸ¥”</span><span class="name">é…¸è¾£åœŸè±†ä¸</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="ç‚’ç¾½è¡£ç”˜è“"><span class="emoji">ğŸ¥—</span><span class="name">ç‚’ç¾½è¡£ç”˜è“</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="é’æ¤’ç‚’é¸¡è›‹"><span class="emoji">ğŸ³</span><span class="name">é’æ¤’ç‚’é¸¡è›‹</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="éº»å©†è±†è…"><span class="emoji">ğŸ±</span><span class="name">éº»å©†è±†è…</span><span class="check-icon">âœ“</span></label>
                    </div>
                </div>
                <div id="soup" class="category-section">
                    <div class="category-title">æ»‹è¡¥æ±¤å“</div>
                    <div class="menu-grid">
                        <label class="menu-item"><input type="checkbox" name="dishes" value="èƒèŸ¹åœŸè±†æ±¤"><span class="emoji">ğŸ¦€</span><span class="name">èƒèŸ¹åœŸè±†æ±¤</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="ç­’éª¨æ±¤"><span class="emoji">ğŸ¥£</span><span class="name">ç­’éª¨æ±¤</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="èåœæ’éª¨æ±¤"><span class="emoji">ğŸ²</span><span class="name">èåœæ’éª¨æ±¤</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="é²«é±¼è±†è…æ±¤"><span class="emoji">ğŸŸ</span><span class="name">é²«é±¼è±†è…æ±¤</span><span class="check-icon">âœ“</span></label>
                    </div>
                </div>
                <div id="staple" class="category-section">
                    <div class="category-title">ç‰¹è‰²ä¸»é£Ÿ</div>
                    <div class="menu-grid">
                        <label class="menu-item"><input type="checkbox" name="dishes" value="ç˜¦è‚‰ä¸¸"><span class="emoji">ğŸ¥£</span><span class="name">æ¸©å·ç˜¦è‚‰ä¸¸</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="èºè›³ç²‰"><span class="emoji">ğŸœ</span><span class="name">æ­£å®—èºè›³ç²‰</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="ç±³é¥­"><span class="emoji">ğŸš</span><span class="name">é¦™ç”œç±³é¥­</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="æ°´é¥º"><span class="emoji">ğŸ¥Ÿ</span><span class="name">æ‰‹å·¥æ°´é¥º</span><span class="check-icon">âœ“</span></label>
                    </div>
                </div>
                <div id="drink" class="category-section">
                    <div class="category-title">é…’æ°´é¥®å“</div>
                    <div class="menu-grid">
                        <label class="menu-item"><input type="checkbox" name="dishes" value="å¯ä¹"><span class="emoji">ğŸ¥¤</span><span class="name">å¯ä¹</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="å•¤é…’"><span class="emoji">ğŸº</span><span class="name">å•¤é…’</span><span class="check-icon">âœ“</span></label>
                        <label class="menu-item"><input type="checkbox" name="dishes" value="é…¸æ¢…æ±¤"><span class="emoji">ğŸ·</span><span class="name">å†°é•‡é…¸æ¢…æ±¤</span><span class="check-icon">âœ“</span></label>
                    </div>
                </div>
                <div id="custom" class="category-section">
                    <div class="category-title">å¤§å¨ç›²ç›’</div>
                    <div class="custom-input-box">
                        <input type="text" id="customDish" placeholder="è¯·è¾“å…¥ä½ æƒ³åƒçš„èœå...">
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div class="footer-bar">
        <div style="font-size:14px; color:#666;">å·²é€‰ <span id="count" style="color:var(--primary-color); font-weight:bold; font-size:20px;">0</span> é“èœ</div>
        <button class="submit-btn" onclick="showRemark()">ä¸€é”®ä¸‹å•</button>
    </div>
</div>

<div id="remarkModal">
    <div class="modal-content">
        <p>æœ‰ä»€ä¹ˆè¦æ±‚ï¼Ÿ</p>
        <textarea id="remarks" placeholder="å°‘ç›ã€ä¸åƒé¦™èœ..."></textarea>
        <div class="modal-btns">
            <button class="btn-cancel" onclick="closeModal()">å–æ¶ˆ</button>
            <button class="btn-confirm" id="finalBtn" onclick="submitOrder()">ç¡®å®šæäº¤</button>
        </div>
    </div>
</div>

<script>
    // åˆå§‹åŒ–æ—¥æœŸ
    document.getElementById('orderDate').valueAsDate = new Date();

    const menuContent = document.getElementById('menuContent');
    const navItems = document.querySelectorAll('.nav-item');
    const sections = document.querySelectorAll('.category-section');

    // 1. ç‚¹å‡»è·³è½¬é€»è¾‘
    navItems.forEach(item => {
        item.addEventListener('click', () => {
            const targetId = item.getAttribute('data-target');
            const targetEl = document.getElementById(targetId);
            menuContent.scrollTo({ top: targetEl.offsetTop, behavior: 'smooth' });
            navItems.forEach(nav => nav.classList.remove('active'));
            item.classList.add('active');
        });
    });

    // 2. è§‚å¯Ÿå™¨è”åŠ¨é«˜äº®
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const id = entry.target.id;
                navItems.forEach(nav => {
                    nav.classList.toggle('active', nav.getAttribute('data-target') === id);
                });
            }
        });
    }, { root: menuContent, threshold: 0.1, rootMargin: "-5% 0px -85% 0px" });
    sections.forEach(section => observer.observe(section));

    // 3. é€‰èœç‚¹å‡»æ•ˆæœ
    document.getElementById('orderForm').addEventListener('change', () => {
        document.querySelectorAll('input[name="dishes"]').forEach(box => {
            box.parentElement.classList.toggle('selected', box.checked);
        });
        document.getElementById('count').innerText = document.querySelectorAll('input[name="dishes"]:checked').length;
    });

    function showRemark() { 
        const selectedCount = document.querySelectorAll('input[name="dishes"]:checked').length;
        const hasCustom = document.getElementById('customDish').value.trim() !== "";
        if(selectedCount === 0 && !hasCustom) return alert('è¯·å…ˆé€‰èœæˆ–å¡«å†™å¤§å¨ç›²ç›’~');
        document.getElementById('remarkModal').style.display = 'flex'; 
    }
    function closeModal() { document.getElementById('remarkModal').style.display = 'none'; }

    // 4. ã€æ ¸å¿ƒæäº¤é€»è¾‘ã€‘ç»“æ„åŒ–å­—ç¬¦ä¸²å‘é€
    async function submitOrder() {
        const btn = document.getElementById('finalBtn');
        const orderDate = document.getElementById('orderDate').value;
        const orderTime = document.getElementById('orderTime').value;
        const userRemarks = document.getElementById('remarks').value || "æ— ";

        // åˆ†ç±»æå–èœå“
        const getSelected = (id) => Array.from(document.querySelectorAll(`#${id} input[name="dishes"]:checked`)).map(el => el.value).join('ã€');
        
        const meat = getSelected('meat');
        const veggie = getSelected('veggie');
        const soup = getSelected('soup');
        const staple = getSelected('staple');
        const drink = getSelected('drink');
        const custom = document.getElementById('customDish').value.trim();

        // æ„å»ºç»“æ„åŒ–æ¸…å•
        let resultString = `ã€ğŸ‘¨â€ğŸ³ å°æŸ¯ç§å¨æ–°è®¢å•ã€‘\n`;
        resultString += `ğŸ“… æ—¥æœŸï¼š${orderDate}\n`;
        resultString += `â° æ—¶é—´ï¼š${orderTime}\n`;
        resultString += `------------------\n`;
        if (meat)   resultString += `ğŸ¥© è¤èœï¼š${meat}\n`;
        if (veggie) resultString += `ğŸ¥¬ ç´ èœï¼š${veggie}\n`;
        if (soup)   resultString += `ğŸ¥£ æ±¤å“ï¼š${soup}\n`;
        if (staple) resultString += `ğŸš ä¸»é£Ÿï¼š${staple}\n`;
        if (drink)  resultString += `ğŸ¥¤ é¥®æ–™ï¼š${drink}\n`;
        if (custom) resultString += `âœ¨ ç›²ç›’ï¼š${custom}\n`;
        resultString += `------------------\n`;
        resultString += `âœï¸ å¤‡æ³¨ï¼š${userRemarks}\n`;
        resultString += `ä¸‹å•æ—¶é—´ï¼š${new Date().toLocaleString()}`;

        // ä½ çš„ Google Form ä¿¡æ¯
        const FORM_URL = "https://docs.google.com/forms/u/0/d/18DVw1zyDQalA5swixMcGxLcBF-i-Nefnega-YjNAaWg/formResponse";
        const DATA_ENTRY_ID = "entry.745536620"; 

        btn.disabled = true;
        btn.innerText = "æ­£åœ¨ä¼ é€...";

        try {
            const formData = new FormData();
            formData.append(DATA_ENTRY_ID, resultString);

            await fetch(FORM_URL, { method: 'POST', mode: 'no-cors', body: formData });
            alert('ğŸ˜‹ è®¢å•å·²æˆåŠŸä¼ è¾¾ï¼');
            location.reload();
        } catch (e) {
            alert('æäº¤å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ');
            btn.disabled = false;
            btn.innerText = "ç¡®å®šæäº¤";
        }
    }
</script>
</body>
</html>